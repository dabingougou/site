---
import '../styles/global.css';
import { getCollection } from 'astro:content';

const papers = await getCollection('papers');
const sorted = papers.sort((a, b) => b.data.year - a.data.year);
const base = import.meta.env.BASE_URL;
const basePrefix = base.endsWith('/') ? base : base + '/';
const href = (path = '') => basePrefix + String(path).replace(/^\/+/, '');
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Papers</title>
  </head>
  <body>
    <main class="container">
      <h1>Papers</h1>
      <p>These are some selected papers I published.</p>
      <ul>
        {sorted.map((p) => (
          <li>
            <a href={href(`papers/${p.slug}/`)}><strong>{p.data.title}</strong></a>
            <br />
            <span>
              {(p.data.authors?.length ? p.data.authors.join(', ') : 'Authors TBD')}
              {' · '}
              {p.data.venue || 'Venue TBD'}
              {' · '}
              {p.data.year}
            </span>
            {p.data.links?.paper && (
              <>
                <br />
                <a href={p.data.links.paper} target="_blank" rel="noopener noreferrer">Journal article link</a>
              </>
            )}
            <br />
            <span>{p.data.summary}</span>
          </li>
        ))}
      </ul>
      <h2>Policy Briefs</h2>
      <ul>
        <li><strong>Economic Perspectives on Long-Distance Bus Services</strong><br /><span>Single-authored policy brief for a non-technical audience on long-distance bus services in BC, focused on market gaps, rural access, and policy implications.</span><br /><a href={href('files/Economics Survey - Long Distance Bus Services - Nov 2025.pdf')} target="_blank" rel="noopener noreferrer">PDF brief</a></li>
      </ul>
      <a href={base}>Back home</a>
    </main>
  </body>
</html>
